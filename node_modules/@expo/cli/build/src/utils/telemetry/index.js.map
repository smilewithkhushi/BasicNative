{"version":3,"sources":["../../../../src/utils/telemetry/index.ts"],"sourcesContent":["import { DetachedClient } from './DetachedClient';\nimport { RudderClient } from './RudderClient';\nimport type { TelemetryClient, TelemetryEvent, TelemetryProperties } from './types';\nimport { env } from '../env';\n\n/** The singleton telemetry client to use */\nlet telemetry: TelemetryClient | null = null;\n\nexport function getTelemetry(): TelemetryClient | null {\n  if (env.EXPO_NO_TELEMETRY || env.EXPO_OFFLINE) return null;\n  if (telemetry) return telemetry;\n\n  const client = env.EXPO_NO_TELEMETRY_DETACH\n    ? new RudderClient() // Block the CLI process when sending telemetry, useful for testing\n    : new DetachedClient(); // Do not block the CLI process when sending telemetry\n\n  process.once('SIGINT', () => client.flush());\n  process.once('SIGTERM', () => client.flush());\n  process.once('beforeExit', () => client.flush());\n\n  return (telemetry = client);\n}\n\nexport async function logEventAsync(event: TelemetryEvent, properties?: TelemetryProperties) {\n  await getTelemetry()?.record({ event, properties });\n}\n"],"names":["getTelemetry","logEventAsync","telemetry","env","EXPO_NO_TELEMETRY","EXPO_OFFLINE","client","EXPO_NO_TELEMETRY_DETACH","RudderClient","DetachedClient","process","once","flush","event","properties","record"],"mappings":"AAAA;;;;;;;;;;;IAQgBA,YAAY,MAAZA,YAAY;IAeNC,aAAa,MAAbA,aAAa;;gCAvBJ,kBAAkB;8BACpB,gBAAgB;qBAEzB,QAAQ;AAE5B,0CAA0C,GAC1C,IAAIC,SAAS,GAA2B,IAAI,AAAC;AAEtC,SAASF,YAAY,GAA2B;IACrD,IAAIG,IAAG,IAAA,CAACC,iBAAiB,IAAID,IAAG,IAAA,CAACE,YAAY,EAAE,OAAO,IAAI,CAAC;IAC3D,IAAIH,SAAS,EAAE,OAAOA,SAAS,CAAC;IAEhC,MAAMI,MAAM,GAAGH,IAAG,IAAA,CAACI,wBAAwB,GACvC,IAAIC,aAAY,aAAA,EAAE,CAAC,mEAAmE;OACtF,IAAIC,eAAc,eAAA,EAAE,AAAC,EAAC,sDAAsD;IAEhFC,OAAO,CAACC,IAAI,CAAC,QAAQ,EAAE,IAAML,MAAM,CAACM,KAAK,EAAE,CAAC,CAAC;IAC7CF,OAAO,CAACC,IAAI,CAAC,SAAS,EAAE,IAAML,MAAM,CAACM,KAAK,EAAE,CAAC,CAAC;IAC9CF,OAAO,CAACC,IAAI,CAAC,YAAY,EAAE,IAAML,MAAM,CAACM,KAAK,EAAE,CAAC,CAAC;IAEjD,OAAQV,SAAS,GAAGI,MAAM,CAAE;AAC9B,CAAC;AAEM,eAAeL,aAAa,CAACY,KAAqB,EAAEC,UAAgC,EAAE;QACrFd,GAAc;IAApB,OAAMA,CAAAA,GAAc,GAAdA,YAAY,EAAE,SAAQ,GAAtBA,KAAAA,CAAsB,GAAtBA,GAAc,CAAEe,MAAM,CAAC;QAAEF,KAAK;QAAEC,UAAU;KAAE,CAAC,CAAA,CAAC;AACtD,CAAC"}